---
title: "Final_Project Report"
author: "Ananya, Rosie, Sameer"
date: '2025-04-04'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

#Set working directory
#knitr::opts_knit$set(root.dir = "/Users/sameerswarup/Documents/Duke MEM Classes/Spring 2025/Time Series Analysis for Energy/RStudio Outputs/Final_Project")

```



```{r, message= FALSE}
#Load libraries
library(tidyverse)
library(forecast)
#library(tseries)
library(sarima)
library(lubridate)
library(Kendall)
library(outliers)
library(foreign)
library(here)
library(cowplot)
library(kableExtra)
library(smooth)
library(tseries)
```

# Introduction
## Motivation and Background
Our group, composed of students from the Coastal Marine Systems and Energy concentrations within the MEM program, chose to explore tidal power due to its strong relevance to our academic and professional interests. Tidal energy presents a compelling case as a clean and sustainable energy source, producing zero greenhouse gas emissions while avoiding the environmental drawbacks of traditional hydro-power, such as dams and large reservoirs. Beyond its ecological benefits, tidal power boasts a high energy density and efficiency—unlike intermittent sources like wind and solar, ocean currents remain relatively constant, ensuring continuous power generation without heavy reliance on costly storage systems. This reliability makes tidal energy a valuable asset in balancing energy grids and complementing other renewables. Additionally, the predictability of tidal currents enhances its appeal as a stable energy solution. While the U.S. currently lacks commercially operational tidal power sites, growing interest and investment, including pilot projects in Maine and New York, signal its potential as a key player in the renewable energy landscape. (Sources of references: altenergymag.com)   

## Project Objectives and Relevance
In this project, we aim to evaluate and compare tidal power potential across three U.S. sites at varying latitudes and coastal conditions. Our assessment focuses on Wave Energy Flux (measured in watts per square meter), which is calculated by Wave Power Density multiplying by Wave Energy Period. We will analyze seasonal and long-term trends in these time-series datasets, apply predictive modeling using training and testing datasets, and compare forecasting results to determine which site offers the most stable and highest Wave Energy Flux. By doing so, we hope to contribute meaningful insights into the feasibility and optimization of tidal energy as a sustainable power source. (Sources of data: NREL Marine Energy) 


# Dataset information
## Data selection and extraction
We first picked 3 sites/ locations/ areas tend to be some of the locations referred to for its tidal power potential in the general Internet searches. These areas are distinct by latitudes and longitudes, as well as different coasts and climatic environments. These three sites are:  
- Gulf of Maine (43.68° N, 
69.77 ° W)   
- ~ 3 km distance into ocean near Miami, Florida  (25.74 ° N,  80.11 ° W)   
- Cook Inlet, Alaska (59.37° N, 152.64° W)  

With the lat-long of these sites, we extracted raw data of 1979-2010 Wave Energy Density and Energy period data in  NREL marine energy atlas: http://nrel.gov/marine-energy-atlas/data-viewer  


## Data Wrangling & General Steps of Analysis
1. Calculate the Wave Energy Flux data based on the raw data we extracted.   
2. Wave Energy Flux datasets for all 3 sites' are aggregated to daily and monthly view (original series).   
3. Split the current full dataset using 80/20 rule into training and testing datasets.  
4. Conduct the original time series analysis on all of the sites.  
5. Run various models to compare predicting/ forecasting performance on the Maine dataset.  
6. Get the top 3 performing models based on the Maine Wave Energy Flux forecasting
7. Use the top 3 performance models (Arima + Fourier k-4, TBATs. and STL+ETS) for the other 2 sites Wave Energy Flux.  
8. Compare Wave Energy Flux Results of the 3 sites and determine which site has more potential. 

## Initial Summary Statistics/ Visualizations of the Datasets

Add here:


# Analysis

```{r}
#Import datasets
here()
getwd()
alaska_df <- read.csv("../Data/Alaska_combined_output.csv",
                      skip = 2,
                      header = TRUE)
florida_df <- read.csv("../Data/Florida_combined_output.csv",
                      skip = 2,
                      header = TRUE)
maine_df <- read.csv("../Data/Gulf of Maine_combined_output.csv",
                      skip = 2,
                      header = TRUE)
```


```{r}
#Create a column that contains daily mean energy period, wave power and wave height and compute mean wave energy flux
alaska_daily_df <- alaska_df %>% 
              group_by(Year, Month, Day) %>%
              summarise(daily_mean_wave_energy = mean(Energy.Period, na.rm = TRUE),
                        daily_mean_wave_height = mean(Significant.Wave.Height, na.rm = TRUE),
                        daily_mean_wave_power = mean(Omni.Directional.Wave.Power, na.rm = TRUE))

florida_daily_df <- florida_df %>% 
              group_by(Year, Month, Day) %>%
              summarise(daily_mean_wave_energy = mean(Energy.Period, na.rm = TRUE),
                        daily_mean_wave_height = mean(Significant.Wave.Height, na.rm = TRUE),
                        daily_mean_wave_power = mean(Omni.Directional.Wave.Power, na.rm = TRUE))

maine_daily_df <- maine_df %>% 
              group_by(Year, Month, Day) %>%
              summarise(daily_mean_wave_energy = mean(Energy.Period, na.rm = TRUE),
                        daily_mean_wave_height = mean(Significant.Wave.Height, na.rm = TRUE),
                        daily_mean_wave_power = mean(Omni.Directional.Wave.Power, na.rm = TRUE))
```

```{r}
#Create a column that contains monthly mean energy period, wave power and wave height and compute mean wave energy flux
alaska_monthly_df <- alaska_daily_df %>% 
              group_by(Year, Month) %>%
              summarise(monthly_mean_wave_energy = mean(daily_mean_wave_energy, na.rm = TRUE),
                        monthly_mean_wave_height = mean(daily_mean_wave_height, na.rm = TRUE),
                        monthly_mean_wave_power = mean(daily_mean_wave_power, na.rm = TRUE))

florida_monthly_df <- florida_daily_df %>% 
              group_by(Year, Month) %>%
              summarise(monthly_mean_wave_energy = mean(daily_mean_wave_energy, na.rm = TRUE),
                        monthly_mean_wave_height = mean(daily_mean_wave_height, na.rm = TRUE),
                        monthly_mean_wave_power = mean(daily_mean_wave_power, na.rm = TRUE))

maine_monthly_df <- maine_daily_df %>% 
              group_by(Year, Month) %>%
              summarise(monthly_mean_wave_energy = mean(daily_mean_wave_energy, na.rm = TRUE),
                        monthly_mean_wave_height = mean(daily_mean_wave_height, na.rm = TRUE),
                        monthly_mean_wave_power = mean(daily_mean_wave_power, na.rm = TRUE))
```

## Maine
We will use Maine to test our various time series models. Using accuracy metrics and plots we will choose the 3 best models and forecast mean monthly wave power for Alaska and Florida.

```{r}
maine_daily_df <- maine_daily_df %>%
  mutate(date = make_date(Year, Month, Day))

maine_monthly_df <- maine_monthly_df %>%
  mutate(date = make_date(Year, Month, 1))

#initial plots
maine_d_plot <- ggplot(maine_daily_df, aes(x = date, y = daily_mean_wave_power)) +
  geom_line(color = "steelblue", alpha = 0.5) +
  labs(title = "Daily Mean Wave Power - Maine", y = "Wave Power (W/m)", x = "") +
  theme_minimal()

maine_m_plot <- ggplot(maine_monthly_df, aes(x = date, y = monthly_mean_wave_power)) +
  geom_line(color = "darkgreen") +
  labs(title = "Monthly Mean Wave Power - Maine", y = "Wave Power (W/m)", x = "") +
  theme_minimal()

plot_grid(maine_d_plot, maine_m_plot, ncol = 1)


#acf plots
maine_d_acf <- ggAcf(maine_daily_df$daily_mean_wave_power) + ggtitle("ACF - Daily Wave Power (Maine)")
maine_m_acf <- ggAcf(maine_monthly_df$monthly_mean_wave_power) + ggtitle("ACF - Monthly Wave Power (Maine)")
plot_grid(maine_d_acf, maine_m_acf, ncol = 1)


```

> Observations: Daily mean wave power appears to be highly volatile and masked by noise, which might make it harder to model directly. On the other hand, monthly mean wave power shows a clear seasonal structure with regular peaks and dips, and consistent annual cycles across decades. 
Moreover, the ACF plot for the daily wave power drops sharply after lag 1, suggesting that past daily values don't carry much signal for future values. For the monthly wave power, the ACF plot shows strong seasonality with the wave pattern. The autocorrelation persists over time, which will be ideal for ARIMA/SARIMA and other seasonal models.


```{r}
#Create training and test datasets using the 80-20 rule (for monthly data only)

#Training
alaska_monthly_train_df <- alaska_monthly_df %>%
                          filter(Year < 2004)
florida_monthly_train_df <- florida_monthly_df %>%
                          filter(Year < 2004)
maine_monthly_train_df <- maine_monthly_df %>%
                          filter(Year < 2004)

alaska_monthly_test_df <- alaska_monthly_df %>%
                          filter(Year > 2003)
florida_monthly_test_df <- florida_monthly_df %>%
                          filter(Year > 2003)
maine_monthly_test_df <- maine_monthly_df %>%
                          filter(Year > 2003)
```


```{r}
#converting to time series object
maine_ts_train <- ts(maine_monthly_train_df$monthly_mean_wave_power,
                     start = c(min(maine_monthly_train_df$Year), min(maine_monthly_train_df$Month)),
                     frequency = 12)

maine_ts_test <- ts(maine_monthly_test_df$monthly_mean_wave_power,
                     start = c(min(maine_monthly_test_df$Year), min(maine_monthly_test_df$Month)),
                     frequency = 12)

maine_train_plot <- autoplot(maine_ts_train) +
  ggtitle("Monthly Mean Wave Power - Maine (Training)") +
  xlab("Year") + ylab("Wave Power (W/m)")
plot(maine_train_plot)

#plotting acf and pacf
maine_train_acf <- ggAcf(maine_ts_train) + ggtitle("ACF - Monthly Wave Power (Maine)")
maine_train_pacf <- ggPacf(maine_ts_train) + ggtitle("PACF - Monthly Wave Power (Maine)")
plot_grid(maine_train_acf, maine_train_pacf, ncol = 1)

#decomposing the time series
maine_train_decomp <- decompose(maine_ts_train)
autoplot(maine_train_decomp)

```


```{r}
#start of the forecasting

fore_h = length(maine_ts_test) #forecast horizon

#model 1: seasonal naive on original data (base model)
maine_snaive <- snaive(maine_ts_train, h = fore_h)
autoplot(maine_snaive) + ggtitle("SNAIVE - Maine")


#model 2: SARIMA on original data
maine_sarima_fit <- auto.arima(maine_ts_train)
print(maine_sarima_fit)

maine_sarima_fore <- forecast(object = maine_sarima_fit, h = fore_h)
autoplot(maine_sarima_fore) + ggtitle("SARIMA - Maine")


#model 3: STL decomposition + ETS
maine_stlf_ets <- stlf(maine_ts_train, h = fore_h, method = "ets")
autoplot(maine_stlf_ets) + ggtitle("STL + ETS Forecast - Maine")


#model 4: ARIMA + Fourier terms
k <- 4  #number of Fourier terms kept at 4, as 5 onwards, the RMSE started increasing

maine_arima_fit <- auto.arima(maine_ts_train, 
                             seasonal=FALSE, 
                             lambda=0,
                             xreg=fourier(maine_ts_train, 
                                          K = k))

maine_arima_fore <- forecast(maine_arima_fit,
                           xreg=fourier(maine_ts_train,
                                        K = k,
                                        h = fore_h),
                           h = fore_h)
autoplot(maine_arima_fore) + ggtitle("ARIMA + Fourier Forecast - Maine")

```

```{r}
n_for <- 11
#played with this, changed to 12, 23, 2 and check if the best model is still the same
maine_SSES <- es(maine_ts_train, model="ZZZ", h=n_for, holdout=FALSE)
checkresiduals(maine_SSES)
# forecast and plot
maine_SSES_fore <- forecast(maine_SSES,h=n_for)
plot(maine_SSES_fore)
```
Model intial interpretation:
- Residuals kind of fluctuate around 0, but the variance is not very constant, but variance have slightly higher value fluctuations > 0, so some inconsistency with potential minor outliers.
- ACF plot: no significant spikes outside of the blue lines, which is good
- Histogram of residuals display rough normal distribution around 0, which is good.
- Ljung-Box test: p-value (0.79) much greater than 0.05, so residuals are white noise, good. 

ACF: since the present value has very low correlation with the previous periods in the short term. Since we are looking at tidal power, longer-term trends may be more important, so es model did not do well. 

```{r}
SS_seas <- StructTS(maine_ts_train,
                    type="BSM",fixed=c(0.1,0.01,0.3,NA)) 

#this function has convergence issues
checkresiduals(SS_seas)

#Generating forecasts
maine_SS_for <- forecast(SS_seas,h=n_for)
plot(maine_SS_for)
```
This model without changes from Module 10 was bad, strong autocorrelation and convergence issue, let's change:
```{r}
maine_ts_train_diff <- diff(maine_ts_train, differences = 1)
SS_seas <- StructTS(maine_ts_train_diff, type = "BSM", , fixed = c(NA, NA, NA, NA))  # Let all parameters vary
checkresiduals(SS_seas)

#Generating forecasts
maine_SS_for <- forecast(SS_seas,h=n_for)
plot(maine_SS_for)

#Plot model + observed data
autoplot(maine_ts_train) +
  autolayer(maine_SS_for, series="SS",PI=FALSE)+
  ylab("Monthly Tidal Power") +
  ggtitle("TBATS forecast of monthly wave power in Maine")
```
Revised model: Residual plot improvements (no trends/outliers) suggest:

- The model handles mean and variance reasonably well.

- The seasonal/trend components are likely adequate.

ACF spikes + low p-value imply:

- Short-term dependencies remain unmodeled (e.g., AR/MA effects).

- Seasonal harmonics (higher-frequency cycles) may be missed.

Next steps could be:
- combine the StructTS model with arima layer

```{r}
#TBATS Model
maine_train_tbats_fit <- tbats(maine_ts_train)

tbats_forecast <- forecast(maine_train_tbats_fit, h=fore_h)

#Plot foresting results
autoplot(tbats_forecast) +
  ylab("Monthly Tidal Power") 

#Plot model + observed data
autoplot(maine_ts_train) +
  autolayer(tbats_forecast, series="TBATS",PI=FALSE)+
  ylab("Monthly Tidal Power") +
  ggtitle("TBATS forecast of monthly wave power in Maine")
```

```{r}
#NNETAR Model

maine_train_NN_fit <- nnetar(maine_ts_train,
                 p=4,
                 P=1,
                 xreg=fourier(maine_ts_train, K = 4))

NN_forecast <- forecast(maine_train_NN_fit, 
                   h=fore_h,
                   xreg=fourier(maine_ts_train, 
                                          K = 4, h=fore_h))


#Plot foresting results
autoplot(NN_forecast) +
  ylab("Monthly Tidal Power") 


#Plot model + observed data
autoplot(maine_ts_train) +
  autolayer(NN_forecast, series="Neural Network",PI=FALSE)+
  ylab("Monthly Tidal Power") 
```

>Observations: Both TBATS and NN under-forecast monthly tidal power. TBATS performs slightly better but both models do not seem to capture the seasonality of the monthly tidal power. For NN, some tweaking can be done to see if changing the lag can better capture the seasonality. 


```{r}
#summarizing the scores/results from the above models
SNAIVE_scores <- accuracy(maine_snaive$mean,maine_ts_test)  
SARIMA_scores <- accuracy(maine_sarima_fore$mean,maine_ts_test)  
ETS_scores <- accuracy(maine_stlf_ets$mean,maine_ts_test)  
ARIMAF_scores <- accuracy(maine_arima_fore$mean,maine_ts_test)
es_scores <- accuracy(maine_SS_for$mean,maine_ts_test)
StructTS_scores <- accuracy(maine_SS_for$mean,maine_ts_test)
TBATS_scores <- accuracy(tbats_forecast$mean,maine_ts_test)  
NN_scores <- accuracy(NN_forecast$mean,maine_ts_test) 

scores <- as.data.frame(
  rbind(SNAIVE_scores, SARIMA_scores, ETS_scores, ARIMAF_scores, es_scores, StructTS_scores, 
        TBATS_scores, NN_scores)
  )
row.names(scores) <- c("SNAIVE", "SARIMA", "STL+ETS", "ARIMA+Fourier", 
                       "ES", "StructTS", "TBAT", "NN")

#choose model with lowest RMSE
best_model_index <- which.min(scores[,"RMSE"])
cat("The best model by RMSE is:", row.names(scores[best_model_index,]))

kbl(scores, 
      caption = "Forecast Accuracy for Monthly Wave Power - Maine",
      digits = array(5,ncol(scores))) %>%
  kable_styling(full_width = FALSE, position = "center", latex_options = "hold_position") %>%
  #highlight model with lowest RMSE
  kable_styling(latex_options="striped", stripe_index = which.min(scores[,"RMSE"]))

```

## Alaska

Start by creating monthly time series objects for Alaska and plotting ACF and PACF plots
```{r}
#converting to time series object
alaska_ts_train <- ts(alaska_monthly_train_df$monthly_mean_wave_power,
                     start = c(min(alaska_monthly_train_df$Year), min(alaska_monthly_train_df$Month)),
                     frequency = 12)

alaska_ts_test <- ts(alaska_monthly_test_df$monthly_mean_wave_power,
                     start = c(min(alaska_monthly_test_df$Year), min(alaska_monthly_test_df$Month)),
                     frequency = 12)

alaska_train_plot <- autoplot(alaska_ts_train) +
  ggtitle("Monthly Mean Wave Power - alaska (Training)") +
  xlab("Year") + ylab("Wave Power (W/m)")
plot(alaska_train_plot)

#plotting acf and pacf
alaska_train_acf <- ggAcf(alaska_ts_train) + ggtitle("ACF - Monthly Wave Power (Alaska)")
alaska_train_pacf <- ggPacf(alaska_ts_train) + ggtitle("PACF - Monthly Wave Power (Alaska)")
plot_grid(alaska_train_acf, alaska_train_pacf, ncol = 1)

#decomposing the time series
alaska_train_decomp <- decompose(alaska_ts_train)
autoplot(alaska_train_decomp)

```

>Observations: The significant spike at lag 1 in both ACF and PACF strongly suggests an AR(1) component. Also, the significant spikes at lag 12 in both ACF and PACF indicate a strong seasonal autoregressive component with a period of 12 months (SAR(1) with a seasonal lag of 12).

```{r}
adf_alaska <- adf.test(alaska_ts_train)
# Print the results
print(adf_alaska)
```

Observations: ADF test returns a p-value of 0.01, which is smaller than our chosen significance level of 0.05. We reject the null hypothesis that the Alaska mean monthly wave power series has a unit root and thus, the series is likely stationary and does not need differencing.  

Proceed with using our 3 chosen models on Alaska  

### Model 1: STL decomposition + ETS
```{r}
fore_h <- length(alaska_ts_test)

#model 1: STL decomposition + ETS
alaska_stlf_ets <- stlf(alaska_ts_train, h = fore_h, method = "ets")
autoplot(alaska_stlf_ets) + ggtitle("STL + ETS Forecast - Alaska")
```

### Model 2: ARIMA + Fourier terms
```{r}
#Model 2: Arima + Fourier
k <- 6 #Value that gives lowest RMSE - need to justify
alaska_arima_fit <- auto.arima(alaska_ts_train, 
                             seasonal=FALSE, 
                             lambda=0,
                             xreg=fourier(alaska_ts_train, 
                                          K = k))

alaska_arima_fore <- forecast(alaska_arima_fit,
                           xreg=fourier(alaska_ts_train,
                                        K = k,
                                        h = fore_h),
                           h = fore_h)
autoplot(alaska_arima_fore) + ggtitle("ARIMA + Fourier Forecast - Alaska")
```


### Model 3: TBATS
```{r}
#Model 3: TBATS
alaska_train_tbats_fit <- tbats(alaska_ts_train)

tbats_forecast <- forecast(alaska_train_tbats_fit, h=fore_h)

#Plot foresting results
autoplot(tbats_forecast) +
  ylab("Monthly Tidal Power") 

#Plot model + observed data
autoplot(alaska_ts_train) +
  autolayer(tbats_forecast, series="TBATS",PI=FALSE)+
  ylab("Monthly Tidal Power") +
  ggtitle("TBATS forecast of monthly wave power in Alaska")
```

```{r}
#summarizing the scores/results from the above models
ETS_scores <- accuracy(alaska_stlf_ets$mean,alaska_ts_test)  
ARIMAF_scores <- accuracy(alaska_arima_fore$mean,alaska_ts_test)
TBATS_scores <- accuracy(tbats_forecast$mean,alaska_ts_test)  

scores <- as.data.frame(
  rbind(ETS_scores, ARIMAF_scores, TBATS_scores)
  )
row.names(scores) <- c("STL+ETS", "ARIMA+Fourier", "TBAT")

#choose model with lowest RMSE
best_model_index <- which.min(scores[,"RMSE"])
cat("The best model by RMSE is:", row.names(scores[best_model_index,]))

kbl(scores, 
      caption = "Forecast Accuracy for Monthly Wave Power - alaska",
      digits = array(5,ncol(scores))) %>%
  kable_styling(full_width = FALSE, position = "center", latex_options = "hold_position") %>%
  #highlight model with lowest RMSE
  kable_styling(latex_options="striped", stripe_index = which.min(scores[,"RMSE"]))

```

## Florida

Start by creating monthly time series objects for Florida and plotting ACF and PACF plots

```{r}
#converting to time series object
florida_ts_train <- ts(florida_monthly_train_df$monthly_mean_wave_power,
                     start = c(min(florida_monthly_train_df$Year), min(florida_monthly_train_df$Month)),
                     frequency = 12)

florida_ts_test <- ts(florida_monthly_test_df$monthly_mean_wave_power,
                     start = c(min(florida_monthly_test_df$Year), min(florida_monthly_test_df$Month)),
                     frequency = 12)

florida_train_plot <- autoplot(florida_ts_train) +
  ggtitle("Monthly Mean Wave Power - Florida (Training)") +
  xlab("Year") + ylab("Wave Power (W/m)")
plot(florida_train_plot)

#plotting acf and pacf
florida_train_acf <- ggAcf(florida_ts_train) + ggtitle("ACF - Monthly Wave Power (Florida)")
florida_train_pacf <- ggPacf(florida_ts_train) + ggtitle("PACF - Monthly Wave Power (Florida)")
plot_grid(florida_train_acf, florida_train_pacf, ncol = 1)

#decomposing the time series
florida_train_decomp <- decompose(florida_ts_train)
autoplot(florida_train_decomp)

```

>Observations: The significant spike at lag 1 in both ACF and PACF strongly suggests an AR(1) component. Also, the repeating seasonal patterns at lag 12 for the ACF suggest strong yearly seasonality.

```{r}
adf_florida <- adf.test(florida_ts_train)
# Print the results
print(adf_florida)
```

>Observations: ADF test returns a p-value of 0.01, which is smaller than our chosen significance level of 0.05. We reject the null hypothesis that the Alaska mean monthly wave power series has a unit root and thus, the series is likely stationary and does not need differencing.

Proceed with using our 3 chosen models on Florida
### Model 1: STL + ETS
```{r}
fore_h <- length(florida_ts_test)

#model 1: STL decomposition + ETS
florida_stlf_ets <- stlf(florida_ts_train, h = fore_h, method = "ets")
autoplot(florida_stlf_ets) + ggtitle("STL + ETS Forecast - Florida")
```

### Model 2: ARIMA + Fourier terms
```{r}
#Model 2: Arima + Fourier
k <- 6 #Value that gives lowest RMSE - need to justify
florida_arima_fit <- auto.arima(florida_ts_train, 
                             seasonal=FALSE, 
                             lambda=0,
                             xreg=fourier(florida_ts_train, 
                                          K = k))

florida_arima_fore <- forecast(florida_arima_fit,
                           xreg=fourier(florida_ts_train,
                                        K = k,
                                        h = fore_h),
                           h = fore_h)
autoplot(florida_arima_fore) + ggtitle("ARIMA + Fourier Forecast - Florida")
```

### Model 3 TBATs
```{r}
#Model 3: TBATS
florida_train_tbats_fit <- tbats(florida_ts_train)

tbats_forecast <- forecast(florida_train_tbats_fit, h=fore_h)

#Plot foresting results
autoplot(tbats_forecast) +
  ylab("Monthly Tidal Power") 

#Plot model + observed data
autoplot(florida_ts_train) +
  autolayer(tbats_forecast, series="TBATS",PI=FALSE)+
  ylab("Monthly Tidal Power") +
  ggtitle("TBATS forecast of monthly wave power in Florida")
```

```{r}
#summarizing the scores/results from the above models
ETS_scores <- accuracy(florida_stlf_ets$mean,florida_ts_test)  
ARIMAF_scores <- accuracy(florida_arima_fore$mean,florida_ts_test)
TBATS_scores <- accuracy(tbats_forecast$mean,florida_ts_test)  

scores <- as.data.frame(
  rbind(ETS_scores, ARIMAF_scores, TBATS_scores)
  )
row.names(scores) <- c("STL+ETS", "ARIMA+Fourier", "TBAT")

#choose model with lowest RMSE
best_model_index <- which.min(scores[,"RMSE"])
cat("The best model by RMSE is:", row.names(scores[best_model_index,]))

kbl(scores, 
      caption = "Forecast Accuracy for Monthly Wave Power - Florida",
      digits = array(5,ncol(scores))) %>%
  kable_styling(full_width = FALSE, position = "center", latex_options = "hold_position") %>%
  #highlight model with lowest RMSE
  kable_styling(latex_options="striped", stripe_index = which.min(scores[,"RMSE"]))

```